class h{constructor(){this.phoneRegex=/^\+?[1-9]\d{1,14}$/,this.emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,this.urlRegex=/^https?:\/\/.+/,this.contactSchema={firstName:{required:!0,type:"string",minLength:1,maxLength:50},lastName:{required:!0,type:"string",minLength:1,maxLength:50},email:{required:!0,type:"email"},phone:{type:"phone"},title:{required:!0,type:"string",minLength:1,maxLength:100},company:{required:!0,type:"string",minLength:1,maxLength:100},industry:{type:"string",maxLength:50},interestLevel:{required:!0,type:"string",enum:["hot","medium","low","cold"]},status:{required:!0,type:"string",enum:["active","pending","inactive","lead","prospect","customer","churned"]},notes:{type:"string",maxLength:1e3},tags:{type:"array"},socialProfiles:{linkedin:{type:"url"},twitter:{type:"url"},website:{type:"url"}}},this.aiAnalysisSchema={contactId:{required:!0,type:"string"},score:{required:!0,type:"number",min:0,max:100},insights:{required:!0,type:"array"},recommendations:{required:!0,type:"array"},confidence:{type:"number",min:0,max:100}},this.enrichmentRequestSchema={email:{type:"email"},firstName:{type:"string",minLength:1},lastName:{type:"string",minLength:1},company:{type:"string",minLength:1},linkedinUrl:{type:"url"}}}validateField(t,i,s){const e=[];if(i.required&&(t==null||t===""))return e.push(`${s} is required`),e;if(t==null||t==="")return e;if(i.type)switch(i.type){case"string":typeof t!="string"&&e.push(`${s} must be a string`);break;case"number":(typeof t!="number"||isNaN(t))&&e.push(`${s} must be a valid number`);break;case"boolean":typeof t!="boolean"&&e.push(`${s} must be a boolean`);break;case"object":(typeof t!="object"||Array.isArray(t))&&e.push(`${s} must be an object`);break;case"array":Array.isArray(t)||e.push(`${s} must be an array`);break;case"email":(typeof t!="string"||!this.emailRegex.test(t))&&e.push(`${s} must be a valid email address`);break;case"phone":(typeof t!="string"||!this.phoneRegex.test(t))&&e.push(`${s} must be a valid phone number`);break;case"url":(typeof t!="string"||!this.urlRegex.test(t))&&e.push(`${s} must be a valid URL`);break}if(typeof t=="string"&&(i.minLength!==void 0&&t.length<i.minLength&&e.push(`${s} must be at least ${i.minLength} characters long`),i.maxLength!==void 0&&t.length>i.maxLength&&e.push(`${s} must be no more than ${i.maxLength} characters long`),i.pattern&&!i.pattern.test(t)&&e.push(`${s} format is invalid`)),typeof t=="number"&&(i.min!==void 0&&t<i.min&&e.push(`${s} must be at least ${i.min}`),i.max!==void 0&&t>i.max&&e.push(`${s} must be no more than ${i.max}`)),i.enum&&!i.enum.includes(t)&&e.push(`${s} must be one of: ${i.enum.join(", ")}`),i.custom){const n=i.custom(t);n!==!0&&e.push(typeof n=="string"?n:`${s} is invalid`)}return e}validateObject(t,i,s=""){const e={};for(const[n,r]of Object.entries(i)){const o=s?`${s}.${n}`:n,m=t?.[n];if(typeof r=="object"&&!Array.isArray(r)&&!r.type){const a=this.validateObject(m,r,o);Object.assign(e,a.errors)}else{const a=this.validateField(m,r,o);a.length>0&&(e[o]=a)}}return{isValid:Object.keys(e).length===0,errors:e}}validate(t,i){return this.validateObject(t,i)}validateContact(t){return this.validate(t,this.contactSchema)}validateAIAnalysis(t){return this.validate(t,this.aiAnalysisSchema)}validateEnrichmentRequest(t){return this.validate(t,this.enrichmentRequestSchema)}sanitizeString(t){return typeof t!="string"?"":t.trim().replace(/[<>]/g,"")}sanitizeEmail(t){return this.sanitizeString(t).toLowerCase()}sanitizePhone(t){const i=this.sanitizeString(t).replace(/[^\d+]/g,"");return i.startsWith("+")?i:`+${i}`}sanitizeContact(t){return{...t,firstName:this.sanitizeString(t.firstName),lastName:this.sanitizeString(t.lastName),email:this.sanitizeEmail(t.email),phone:t.phone?this.sanitizePhone(t.phone):void 0,title:this.sanitizeString(t.title),company:this.sanitizeString(t.company),industry:this.sanitizeString(t.industry),notes:this.sanitizeString(t.notes)}}sanitizeDeal(t){return{...t,title:t.title?this.sanitizeString(t.title):"",description:t.description?this.sanitizeString(t.description):"",contactName:t.contactName?this.sanitizeString(t.contactName):"",company:t.company?this.sanitizeString(t.company):"",assigneeName:t.assigneeName?this.sanitizeString(t.assigneeName):"",value:typeof t.value=="number"?t.value:0,probability:typeof t.probability=="number"?Math.max(0,Math.min(100,t.probability)):0,stage:t.stage?this.sanitizeString(t.stage):"discovery",status:t.status?this.sanitizeString(t.status):"active",priority:t.priority?this.sanitizeString(t.priority):"medium",tags:Array.isArray(t.tags)?t.tags.map(i=>this.sanitizeString(i)).filter(Boolean):[],contactId:t.contactId?this.sanitizeString(t.contactId):"",assigneeId:t.assigneeId?this.sanitizeString(t.assigneeId):"",expectedCloseDate:t.expectedCloseDate,aiScore:typeof t.aiScore=="number"?Math.max(0,Math.min(100,t.aiScore)):void 0,activities:Array.isArray(t.activities)?t.activities:[]}}}const g=new h;export{g as v};
