import{j as e,r as t,bw as p,bt as b,a3 as j,bu as m,bv as y}from"./index-e3V0CD7Y.js";const v=()=>{const[s,u]=t.useState(null),[d,x]=t.useState(null),[h,c]=t.useState(!0),[l,f]=t.useState(!1),n=t.useRef(null),{isDark:N}=p();if(t.useEffect(()=>{(async()=>{try{console.log("🚀 Loading Calendar via Module Federation..."),console.log("📍 Remote URL: https://calendar.smartcrm.vip/remoteEntry.js");const o=await y("https://calendar.smartcrm.vip","CalendarApp","./CalendarApp"),i=o.default||o;u(()=>i),m.registerModule("calendar",i,{appointments:[]}),console.log("✅ Module Federation Calendar loaded successfully"),c(!1)}catch(r){console.error("❌ Module Federation failed:",r),console.log("📺 Falling back to iframe for Calendar..."),x(r.message||"Failed to load Module Federation calendar"),f(!0),c(!1)}})()},[]),t.useEffect(()=>{if(!l||!n.current)return;const a=n.current,r=()=>{try{a.contentWindow?.postMessage({type:"SET_THEME",theme:"light"},"*")}catch{console.log("Unable to communicate with Calendar iframe for theme setting")}};return a.addEventListener("load",r),()=>a.removeEventListener("load",r)},[l]),h)return e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading Calendar Module..."})]})});if(l)return e.jsx("div",{className:"w-full h-full bg-white","data-testid":"calendar-iframe-fallback",children:e.jsx("iframe",{ref:n,src:"https://calendar.smartcrm.vip",className:"w-full h-full border-0",style:{width:"100%",height:"100%",minHeight:"600px"},title:"AI Calendar",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})});if(d&&!l)return e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-2xl mx-auto p-8 text-center",children:[e.jsx("div",{className:"mb-6",children:e.jsx("svg",{className:"w-16 h-16 mx-auto text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Unable to Load Calendar"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"The calendar module could not be loaded. Please try again later."}),d&&e.jsxs("details",{className:"text-left bg-gray-100 dark:bg-gray-800 rounded-lg p-4",children:[e.jsx("summary",{className:"cursor-pointer font-medium text-gray-900 dark:text-white mb-2",children:"Technical Details"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.jsxs("p",{className:"text-red-600 dark:text-red-400",children:[e.jsx("strong",{children:"Error:"})," ",d]})})]})]})});const g=b(a=>a.sharedData);return j.createElement(s,{theme:"light",mode:"light",sharedData:g,onDataUpdate:a=>{m.broadcastToAllModules("CALENDAR_DATA_UPDATE",a)}})},w=({showHeader:s=!1})=>e.jsxs("div",{className:"h-full w-full flex flex-col",style:{margin:0,padding:0},"data-testid":"calendar-month",children:[s&&e.jsx("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"AI Calendar"}),e.jsxs("div",{className:"flex items-center text-green-600 text-xs",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Loaded"]})]})}),e.jsx("div",{className:"flex-1 w-full h-full",style:{margin:0,padding:0},children:e.jsx(v,{})})]}),k=()=>e.jsx("div",{className:"h-full w-full",children:e.jsx(w,{showHeader:!1})});export{k as default};
